from src.main.python.utils.dictionary_helper import *

if __name__ == '__main__':

  down_vars="all_input_enabled=false,client_subscriber_topics_replica=solma-dec18-g,config_version=next,deadline_days=1,default_livegraph_worker_replicas=2,disable_client_subscriber_topics=false,include_eval_flow_control=false,include_gc-stale-records=false,include_progress_monitor=false,output_enabled=false,run_loader=false,source_clone_pinax_cluster_full=/ls/oe/storage/pinax/production/testing/ttl=1d/livegraph-mini_testing_instance,source_instance=mini_testing_instance"
  purge_vars="all_input_enabled=false,client_subscriber_topics_replica=solma-dec18-g,config_version=next,deadline_days=1,default_livegraph_worker_replicas=2,disable_client_subscriber_topics=false,include_eval_flow_control=false,include_gc-stale-records=false,include_progress_monitor=false,output_enabled=false,run_loader=false,source_clone_pinax_cluster_full=/ls/oe/storage/pinax/production/testing/ttl=1d/livegraph-mini_testing_instance,source_instance=mini_testing_instance"
  assert  diff(down_vars, purge_vars, this_dict_factory=as_dict, that_dict_factory=as_dict, print_result=True)

  # borcfg --vars
  borcfg_cmd_vars = "all_input_enabled=false,client_subscriber_topics_replica=solma-x,config_mpm_version=test_mpm_citc_solma_1_136__c_opt_9aa02bd4,config_version=next,deadline_days=1,default_livegraph_worker_replicas=2,disable_client_subscriber_topics=false,include_eval_flow_control=false,include_gc-stale-records=false,include_progress_monitor=false,input_environment=solma-x,instance=solma-x-side_b,loader_input_goops_topic=/pubsub2/test/livegraph-input:solma-x,mpm_version=test_mpm_citc_solma_1_136__c_opt_9aa02bd4,output_enabled=false,pinax_cluster_full=/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-x-side_b,run_loader=false"

  # EqualGroup
  # mini --vars # self.vars in '-> handler = self.environment.GetHandlerByBorgFileRef(borgfile_ref, self.vars)'
  mini_cmd_vars = "all_input_enabled=false,client_subscriber_topics_replica=solma-nov21-d,config_version=next,deadline_days=1,default_livegraph_worker_replicas=2,disable_client_subscriber_topics=false,include_eval_flow_control=false,include_gc-stale-records=false,include_progress_monitor=false,input_environment=solma-nov21-d,loader_input_goops_topic=/pubsub2/test/livegraph-input:solma-nov21-d,output_enabled=false,pinax_cluster_full=/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a,run_loader=false"
  # handler.BorgCfg()._borgcfg_vars
  borgcfg_vars = {u'input_environment': u'solma-nov21-d', u'run_loader': False,
                  u'loader_input_goops_topic': u'/pubsub2/test/livegraph-input:solma-nov21-d',
                  u'config_version': u'next', u'disable_client_subscriber_topics': False, u'all_input_enabled': False,
                  u'include_eval_flow_control': False, u'default_livegraph_worker_replicas': 2, u'deadline_days': 1,
                  u'pinax_cluster_full': u'/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a',
                  u'include_progress_monitor': False, u'client_subscriber_topics_replica': u'solma-nov21-d',
                  u'include_gc-stale-records': False, u'output_enabled': False}
  assert  diff(borgcfg_vars, mini_cmd_vars, this_dict_factory=dict, that_dict_factory=as_dict, print_result=True)


  # handler.BorgCfg()._borgcfg_mini_vars
  borgcfg_mini_vars = {u'run_loader': False, u'output_enabled': False, u'disable_client_subscriber_topics': False,
                       u'all_input_enabled': False, u'deadline_days': 1,
                       u'pinax_cluster_full': u'/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a',
                       u'include_progress_monitor': False, u'client_subscriber_topics_replica': u'solma-nov21-d',
                       'config_mpm_version': 'test_mpm_108351659__c_opt_9aa02bd4',
                       'input_environment': u'solma-nov21-d', u'config_version': u'next',
                       u'loader_input_goops_topic': u'/pubsub2/test/livegraph-input:solma-nov21-d',
                       u'include_eval_flow_control': False, u'default_livegraph_worker_replicas': 2,
                       u'include_gc-stale-records': False, 'mpm_version': 'test_mpm_108351659__c_opt_9aa02bd4',
                       'instance': u'solma-nov21-d-side_a'}
  diff(borgcfg_vars, borgcfg_mini_vars, this_dict_factory=dict, that_dict_factory=dict, print_result=False)

  # EqualGroup
  # handler.BorgCfg().GetMini()
  borgcfg_get_mini = "{'required_files': {'global_pinax_cluster': None, 'exp_source_data_checkpoint_file': None, 'source_data_checkpoint_file': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source_data_checkpoint', 'user': 'livegraph-dev'}}, 'input_environment_var': 'input_environment', 'handler': 'mini.handler.Livegraph', 'user': 'livegraph-dev', 'build_targets': {'livegraph_package': {'target': 'knowledge/graph/livegraph:livegraph_mpm', 'mpm_label_var': 'mpm_version', 'build_options': {'durability': '--mpm_build_arg=--durability=TEST', 'extra_label': None}, 'mpm_label_prefix': 'test_'}, 'livegraph_config_package': {'target': 'knowledge/graph/livegraph:livegraph_config_mpm', 'mpm_label_var': 'config_mpm_version', 'build_options': {'durability': '--mpm_build_arg=--durability=TEST', 'extra_label': None}, 'mpm_label_prefix': 'test_'}, 'pinax_package': {'target': 'knowledge/graph/livegraph:pinax_mpm', 'mpm_label_var': 'mpm_version', 'build_options': {'durability': '--mpm_build_arg=--durability=TEST', 'extra_label': None}, 'mpm_label_prefix': 'test_'}, 'gatekeeper_package': None, 'livegraph_release_tools_package': None, 'livegraph_monitoring_package': {'target': 'knowledge/graph/livegraph:livegraph_monitoring_mpm', 'mpm_label_var': 'mpm_version', 'build_options': {'durability': '--mpm_build_arg=--durability=TEST', 'extra_label': None}, 'mpm_label_prefix': 'test_'}}, 'deadline_days': 1, 'init_tablet_split': {'run': False, 'mpm': {'file_name': 'init-tablet-split', 'version': 'test_mpm_108351659__c_opt_9aa02bd4', 'pkg': 'knowledge/graph/livegraph/tools/release-tools'}}, 'environment_var': 'instance', 'mpm_version': 'test_mpm_108351659__c_opt_9aa02bd4', 'worker_job_name': 'livegraph-solma-nov21-d-side_a.workers', 'livegraph_log_info': {'key_values': {'livegraph_output_topic_suffix': 'solma-nov21-d-side_a', 'run_gatekeeper': False, 'loading_tags': 'mini', 'pinax_cluster_full': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'run_table_stats': False, 'deadline_days': 1, 'source_data_base_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source', 'geo_loader_livegraph_publisher_realtime_topic': '', 'run_exp_data_tracking': False, 'run_geo_loader_validator': False, 'update_exp_borg_job_topic': '/pubsub2/test/ephemeral:livegraph-update-exp-borg-job-solma-nov21-d-side_a', 'run_loader': False, 'run_exp_validators': False, 'run_pinax_repair': False, 'batch_input_goops_topic': '/pubsub2/test/livegraph-batch-input:solma-nov21-d-side_a', 'input_goops_topic': '/pubsub2/test/livegraph-input:solma-nov21-d', 'prod_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary', 'canary_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary-canary', 'input_environment': 'solma-nov21-d', 'disable_client_subscriber_topics': False, 'run_election': False, 'run_borgmon': False, 'epoch_notification_topic': '/pubsub2/test/ephemeral:livegraph-epoch-complete-solma-nov21-d-side_a', 'allow_experiments': False, 'unified_exp_loader_topic': '/pubsub2/test/ephemeral:livegraph-input-mini-expt-solma-nov21-d-side_a', 'run_geo_loader': False, 'topic_server_epoch_completion_topic': '/pubsub2/test/ephemeral:topicserver-epoch-complete-solma-nov21-d-side_a', 'use_large_experiments_topic': False, 'kg_schema_root_dir': '/namespace/livegraph/global/schema/ttl=30d', 'run_promote_mid': False, 'run_load_rm_signals': False, 'run_as_datacanary': False, 'geo_loader_livegraph_publisher_topic': '', 'include_batch_monitor': False, 'instance_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a', 'livegraph_output_topic_prefix': ''}, 'sorted': True}, 'cell': 'qf', 'is_prod': False, 'required_directories': {'prewrite_cleaner_flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/prewrite_cleaner', 'user': 'livegraph-dev'}, 'flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/flagfiles', 'user': 'livegraph-dev'}, 'exp_source_data_basedir': None, 'gatekeeper_base_dir': None, 'gc_record_working_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/gc/ttl=7d', 'user': 'livegraph-dev'}, 'validators_base_dir': None, 'source_data_basedir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source', 'delete_on_purge': True, 'user': 'livegraph-dev'}, 'event_log_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/event-logs/ttl=7d', 'user': 'livegraph-dev'}, 'kg_schema_root_dir': {'name': '/namespace/livegraph/global/schema/ttl=30d', 'delete_on_purge': False, 'user': 'livegraph-dev'}, 'instance_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a', 'user': 'livegraph-dev'}, 'mr_table_stats_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/mr-table-stats-logs/ttl=7d', 'user': 'livegraph-dev'}}, 'default_binary_ref': '@none', 'user_var': 'user', 'mpm_extra_label': None, 'livegraph_required_pinax_cluster': {'bt_cell': 'qf-i-shared', 'partition': 'default', 'default_owner_as_user': False, 'user': 'livegraph-dev', 'bt_prefix': 'livegraph-dev.solma-nov21-d-side_a.pinax', 'clear_production_fields': True, 'schema_template_substitution_map': {'bt_cell': None, 'partition': 'default', 'data_fs_root_id': 0, 'table_writers': ['chubby!mdb/livegraph-dev'], 'table_owner': 'chubby!mdb/livegraph-dev', 'table_administrator': 'chubby!mdb/livegraph-dev', 'write_only_fs_root_id': 0}, 'die_after_days': 1, 'administrators': 'chubby!mdb/livegraph-dev', 'setschema_show_diff': False, 'writers': ['chubby!mdb/livegraph-dev'], 'metadata_dir': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'schema_mpm': {'filegroups': 'data', 'pkg_name': 'knowledge/graph/livegraph', 'version': 'test_mpm_108351659__c_opt_9aa02bd4'}, 'schema': 'knowledge/graph/livegraph/storage/livegraph.schema.template'}, 'pubsub_subscribers': {'client_input': {'id': 'livegraph_dev_sub:solma-nov21-d-side_a', 'topics': '/pubsub2/test/livegraph-input:solma-nov21-d-side_a'}}}"
  # handler.GetMini()
  handler_get_mini= "{'required_files': {'global_pinax_cluster': None, 'exp_source_data_checkpoint_file': None, 'source_data_checkpoint_file': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source_data_checkpoint', 'user': 'livegraph-dev'}}, 'input_environment_var': 'input_environment', 'handler': 'mini.handler.Livegraph', 'user': 'livegraph-dev', 'build_targets': {'livegraph_package': {'target': 'knowledge/graph/livegraph:livegraph_mpm', 'mpm_label_var': 'mpm_version', 'build_options': {'durability': '--mpm_build_arg=--durability=TEST', 'extra_label': None}, 'mpm_label_prefix': 'test_'}, 'livegraph_config_package': {'target': 'knowledge/graph/livegraph:livegraph_config_mpm', 'mpm_label_var': 'config_mpm_version', 'build_options': {'durability': '--mpm_build_arg=--durability=TEST', 'extra_label': None}, 'mpm_label_prefix': 'test_'}, 'pinax_package': {'target': 'knowledge/graph/livegraph:pinax_mpm', 'mpm_label_var': 'mpm_version', 'build_options': {'durability': '--mpm_build_arg=--durability=TEST', 'extra_label': None}, 'mpm_label_prefix': 'test_'}, 'gatekeeper_package': None, 'livegraph_release_tools_package': None, 'livegraph_monitoring_package': {'target': 'knowledge/graph/livegraph:livegraph_monitoring_mpm', 'mpm_label_var': 'mpm_version', 'build_options': {'durability': '--mpm_build_arg=--durability=TEST', 'extra_label': None}, 'mpm_label_prefix': 'test_'}}, 'deadline_days': 1, 'init_tablet_split': {'run': False, 'mpm': {'file_name': 'init-tablet-split', 'version': 'test_mpm_108351659__c_opt_9aa02bd4', 'pkg': 'knowledge/graph/livegraph/tools/release-tools'}}, 'environment_var': 'instance', 'mpm_version': 'test_mpm_108351659__c_opt_9aa02bd4', 'worker_job_name': 'livegraph-solma-nov21-d-side_a.workers', 'livegraph_log_info': {'key_values': {'livegraph_output_topic_suffix': 'solma-nov21-d-side_a', 'run_gatekeeper': False, 'loading_tags': 'mini', 'pinax_cluster_full': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'run_table_stats': False, 'deadline_days': 1, 'source_data_base_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source', 'geo_loader_livegraph_publisher_realtime_topic': '', 'run_exp_data_tracking': False, 'run_geo_loader_validator': False, 'update_exp_borg_job_topic': '/pubsub2/test/ephemeral:livegraph-update-exp-borg-job-solma-nov21-d-side_a', 'run_loader': False, 'run_exp_validators': False, 'run_pinax_repair': False, 'batch_input_goops_topic': '/pubsub2/test/livegraph-batch-input:solma-nov21-d-side_a', 'input_goops_topic': '/pubsub2/test/livegraph-input:solma-nov21-d', 'prod_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary', 'canary_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary-canary', 'input_environment': 'solma-nov21-d', 'disable_client_subscriber_topics': False, 'run_election': False, 'run_borgmon': False, 'epoch_notification_topic': '/pubsub2/test/ephemeral:livegraph-epoch-complete-solma-nov21-d-side_a', 'allow_experiments': False, 'unified_exp_loader_topic': '/pubsub2/test/ephemeral:livegraph-input-mini-expt-solma-nov21-d-side_a', 'run_geo_loader': False, 'topic_server_epoch_completion_topic': '/pubsub2/test/ephemeral:topicserver-epoch-complete-solma-nov21-d-side_a', 'use_large_experiments_topic': False, 'kg_schema_root_dir': '/namespace/livegraph/global/schema/ttl=30d', 'run_promote_mid': False, 'run_load_rm_signals': False, 'run_as_datacanary': False, 'geo_loader_livegraph_publisher_topic': '', 'include_batch_monitor': False, 'instance_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a', 'livegraph_output_topic_prefix': ''}, 'sorted': True}, 'cell': 'qf', 'is_prod': False, 'required_directories': {'prewrite_cleaner_flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/prewrite_cleaner', 'user': 'livegraph-dev'}, 'flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/flagfiles', 'user': 'livegraph-dev'}, 'exp_source_data_basedir': None, 'gatekeeper_base_dir': None, 'gc_record_working_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/gc/ttl=7d', 'user': 'livegraph-dev'}, 'validators_base_dir': None, 'source_data_basedir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source', 'delete_on_purge': True, 'user': 'livegraph-dev'}, 'event_log_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/event-logs/ttl=7d', 'user': 'livegraph-dev'}, 'kg_schema_root_dir': {'name': '/namespace/livegraph/global/schema/ttl=30d', 'delete_on_purge': False, 'user': 'livegraph-dev'}, 'instance_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a', 'user': 'livegraph-dev'}, 'mr_table_stats_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/mr-table-stats-logs/ttl=7d', 'user': 'livegraph-dev'}}, 'default_binary_ref': '@none', 'user_var': 'user', 'mpm_extra_label': None, 'livegraph_required_pinax_cluster': {'bt_cell': 'qf-i-shared', 'partition': 'default', 'default_owner_as_user': False, 'user': 'livegraph-dev', 'bt_prefix': 'livegraph-dev.solma-nov21-d-side_a.pinax', 'clear_production_fields': True, 'schema_template_substitution_map': {'bt_cell': None, 'partition': 'default', 'data_fs_root_id': 0, 'table_writers': ['chubby!mdb/livegraph-dev'], 'table_owner': 'chubby!mdb/livegraph-dev', 'table_administrator': 'chubby!mdb/livegraph-dev', 'write_only_fs_root_id': 0}, 'die_after_days': 1, 'administrators': 'chubby!mdb/livegraph-dev', 'setschema_show_diff': False, 'writers': ['chubby!mdb/livegraph-dev'], 'metadata_dir': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'schema_mpm': {'filegroups': 'data', 'pkg_name': 'knowledge/graph/livegraph', 'version': 'test_mpm_108351659__c_opt_9aa02bd4'}, 'schema': 'knowledge/graph/livegraph/storage/livegraph.schema.template'}, 'pubsub_subscribers': {'client_input': {'id': 'livegraph_dev_sub:solma-nov21-d-side_a', 'topics': '/pubsub2/test/livegraph-input:solma-nov21-d-side_a'}}}"
  # borgcfg.BorgCfg(handler.BorgCfg().BorgFile(),handler.BorgCfg()._borgcfg_vars,handler.BorgCfg()._borgcfg_mini_vars, handler.Environment()).GetMini()
  new_borgcfg_get_mini = "{'default_binary_ref': '@none', 'cell': 'qf', 'input_environment_var': 'input_environment', 'required_files': {'global_pinax_cluster': None, 'source_data_checkpoint_file': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source_data_checkpoint', 'user': 'livegraph-dev'}, 'exp_source_data_checkpoint_file': None}, 'mpm_version': 'test_mpm_108351659__c_opt_9aa02bd4', 'pubsub_subscribers': {'client_input': {'id': 'livegraph_dev_sub:solma-nov21-d-side_a', 'topics': '/pubsub2/test/livegraph-input:solma-nov21-d-side_a'}}, 'environment_var': 'instance', 'handler': 'mini.handler.Livegraph', 'worker_job_name': 'livegraph-solma-nov21-d-side_a.workers', 'build_targets': {'pinax_package': {'target': 'knowledge/graph/livegraph:pinax_mpm', 'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'mpm_label_var': 'mpm_version', 'mpm_label_prefix': 'test_'}, 'livegraph_package': {'target': 'knowledge/graph/livegraph:livegraph_mpm', 'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'mpm_label_var': 'mpm_version', 'mpm_label_prefix': 'test_'}, 'livegraph_monitoring_package': {'target': 'knowledge/graph/livegraph:livegraph_monitoring_mpm', 'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'mpm_label_var': 'mpm_version', 'mpm_label_prefix': 'test_'}, 'livegraph_release_tools_package': None, 'gatekeeper_package': None, 'livegraph_config_package': {'target': 'knowledge/graph/livegraph:livegraph_config_mpm', 'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'mpm_label_var': 'config_mpm_version', 'mpm_label_prefix': 'test_'}}, 'deadline_days': 1, 'user_var': 'user', 'init_tablet_split': {'run': False, 'mpm': {'file_name': 'init-tablet-split', 'version': 'test_mpm_108351659__c_opt_9aa02bd4', 'pkg': 'knowledge/graph/livegraph/tools/release-tools'}}, 'livegraph_required_pinax_cluster': {'user': 'livegraph-dev', 'clear_production_fields': True, 'schema': 'knowledge/graph/livegraph/storage/livegraph.schema.template', 'bt_cell': 'qf-i-shared', 'schema_template_substitution_map': {'partition': 'default', 'data_fs_root_id': 0, 'bt_cell': None, 'table_writers': ['chubby!mdb/livegraph-dev'], 'table_administrator': 'chubby!mdb/livegraph-dev', 'write_only_fs_root_id': 0, 'table_owner': 'chubby!mdb/livegraph-dev'}, 'bt_prefix': 'livegraph-dev.solma-nov21-d-side_a.pinax', 'schema_mpm': {'filegroups': 'data', 'version': 'test_mpm_108351659__c_opt_9aa02bd4', 'pkg_name': 'knowledge/graph/livegraph'}, 'setschema_show_diff': False, 'partition': 'default', 'writers': ['chubby!mdb/livegraph-dev'], 'administrators': 'chubby!mdb/livegraph-dev', 'metadata_dir': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'die_after_days': 1, 'default_owner_as_user': False}, 'required_directories': {'kg_schema_root_dir': {'name': '/namespace/livegraph/global/schema/ttl=30d', 'delete_on_purge': False, 'user': 'livegraph-dev'}, 'validators_base_dir': None, 'flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/flagfiles', 'user': 'livegraph-dev'}, 'gc_record_working_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/gc/ttl=7d', 'user': 'livegraph-dev'}, 'gatekeeper_base_dir': None, 'event_log_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/event-logs/ttl=7d', 'user': 'livegraph-dev'}, 'prewrite_cleaner_flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/prewrite_cleaner', 'user': 'livegraph-dev'}, 'exp_source_data_basedir': None, 'instance_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a', 'user': 'livegraph-dev'}, 'mr_table_stats_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/mr-table-stats-logs/ttl=7d', 'user': 'livegraph-dev'}, 'source_data_basedir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source', 'delete_on_purge': True, 'user': 'livegraph-dev'}}, 'mpm_extra_label': None, 'user': 'livegraph-dev', 'livegraph_log_info': {'sorted': True, 'key_values': {'loading_tags': 'mini', 'use_large_experiments_topic': False, 'topic_server_epoch_completion_topic': '/pubsub2/test/ephemeral:topicserver-epoch-complete-solma-nov21-d-side_a', 'livegraph_output_topic_prefix': '', 'kg_schema_root_dir': '/namespace/livegraph/global/schema/ttl=30d', 'disable_client_subscriber_topics': False, 'run_load_rm_signals': False, 'run_exp_data_tracking': False, 'run_gatekeeper': False, 'update_exp_borg_job_topic': '/pubsub2/test/ephemeral:livegraph-update-exp-borg-job-solma-nov21-d-side_a', 'run_as_datacanary': False, 'run_geo_loader_validator': False, 'run_borgmon': False, 'geo_loader_livegraph_publisher_topic': '', 'epoch_notification_topic': '/pubsub2/test/ephemeral:livegraph-epoch-complete-solma-nov21-d-side_a', 'run_pinax_repair': False, 'input_goops_topic': '/pubsub2/test/livegraph-input:solma-nov21-d', 'livegraph_output_topic_suffix': 'solma-nov21-d-side_a', 'run_loader': False, 'run_geo_loader': False, 'run_table_stats': False, 'input_environment': 'solma-nov21-d', 'source_data_base_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source', 'run_election': False, 'instance_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a', 'batch_input_goops_topic': '/pubsub2/test/livegraph-batch-input:solma-nov21-d-side_a', 'geo_loader_livegraph_publisher_realtime_topic': '', 'deadline_days': 1, 'canary_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary-canary', 'run_exp_validators': False, 'run_promote_mid': False, 'include_batch_monitor': False, 'unified_exp_loader_topic': '/pubsub2/test/ephemeral:livegraph-input-mini-expt-solma-nov21-d-side_a', 'pinax_cluster_full': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'prod_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary', 'allow_experiments': False}}, 'is_prod': False}"

  #handler.Environment()._GetHandlerFactoryByRef('mini.handler.Livegraph')(handler.BorgCfg().BorgFile(),handler.Environment(), borgcfg_vars=handler.BorgCfg()._borgcfg_vars).GetMini()
  new_handler_get_mini = "{'default_binary_ref': '@none', 'cell': 'qf', 'input_environment_var': " \
                         "'input_environment', 'required_files': {'global_pinax_cluster': None, 'source_data_checkpoint_file': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source_data_checkpoint', 'user': 'livegraph-dev'}, 'exp_source_data_checkpoint_file': None}, 'mpm_version': 'test_mpm_108351659__c_opt_9aa02bd4', 'pubsub_subscribers': {'client_input': {'id': 'livegraph_dev_sub:solma-nov21-d-side_a', 'topics': '/pubsub2/test/livegraph-input:solma-nov21-d-side_a'}}, 'environment_var': 'instance', 'handler': 'mini.handler.Livegraph', 'worker_job_name': 'livegraph-solma-nov21-d-side_a.workers', 'build_targets': {'pinax_package': {'target': 'knowledge/graph/livegraph:pinax_mpm', 'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'mpm_label_var': 'mpm_version', 'mpm_label_prefix': 'test_'}, 'livegraph_package': {'target': 'knowledge/graph/livegraph:livegraph_mpm', 'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'mpm_label_var': 'mpm_version', 'mpm_label_prefix': 'test_'}, 'livegraph_monitoring_package': {'target': 'knowledge/graph/livegraph:livegraph_monitoring_mpm', 'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'mpm_label_var': 'mpm_version', 'mpm_label_prefix': 'test_'}, 'livegraph_release_tools_package': None, 'gatekeeper_package': None, 'livegraph_config_package': {'target': 'knowledge/graph/livegraph:livegraph_config_mpm', 'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'mpm_label_var': 'config_mpm_version', 'mpm_label_prefix': 'test_'}}, 'deadline_days': 1, 'user_var': 'user', 'init_tablet_split': {'run': False, 'mpm': {'file_name': 'init-tablet-split', 'version': 'test_mpm_108351659__c_opt_9aa02bd4', 'pkg': 'knowledge/graph/livegraph/tools/release-tools'}}, 'livegraph_required_pinax_cluster': {'user': 'livegraph-dev', 'clear_production_fields': True, 'schema': 'knowledge/graph/livegraph/storage/livegraph.schema.template', 'bt_cell': 'qf-i-shared', 'schema_template_substitution_map': {'partition': 'default', 'data_fs_root_id': 0, 'bt_cell': None, 'table_writers': ['chubby!mdb/livegraph-dev'], 'table_administrator': 'chubby!mdb/livegraph-dev', 'write_only_fs_root_id': 0, 'table_owner': 'chubby!mdb/livegraph-dev'}, 'bt_prefix': 'livegraph-dev.solma-nov21-d-side_a.pinax', 'schema_mpm': {'filegroups': 'data', 'version': 'test_mpm_108351659__c_opt_9aa02bd4', 'pkg_name': 'knowledge/graph/livegraph'}, 'setschema_show_diff': False, 'partition': 'default', 'writers': ['chubby!mdb/livegraph-dev'], 'administrators': 'chubby!mdb/livegraph-dev', 'metadata_dir': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'die_after_days': 1, 'default_owner_as_user': False}, 'required_directories': {'kg_schema_root_dir': {'name': '/namespace/livegraph/global/schema/ttl=30d', 'delete_on_purge': False, 'user': 'livegraph-dev'}, 'validators_base_dir': None, 'flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/flagfiles', 'user': 'livegraph-dev'}, 'gc_record_working_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/gc/ttl=7d', 'user': 'livegraph-dev'}, 'gatekeeper_base_dir': None, 'event_log_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/event-logs/ttl=7d', 'user': 'livegraph-dev'}, 'prewrite_cleaner_flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/prewrite_cleaner', 'user': 'livegraph-dev'}, 'exp_source_data_basedir': None, 'instance_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a', 'user': 'livegraph-dev'}, 'mr_table_stats_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/mr-table-stats-logs/ttl=7d', 'user': 'livegraph-dev'}, 'source_data_basedir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source', 'delete_on_purge': True, 'user': 'livegraph-dev'}}, 'mpm_extra_label': None, 'user': 'livegraph-dev', 'livegraph_log_info': {'sorted': True, 'key_values': {'loading_tags': 'mini', 'use_large_experiments_topic': False, 'topic_server_epoch_completion_topic': '/pubsub2/test/ephemeral:topicserver-epoch-complete-solma-nov21-d-side_a', 'livegraph_output_topic_prefix': '', 'kg_schema_root_dir': '/namespace/livegraph/global/schema/ttl=30d', 'disable_client_subscriber_topics': False, 'run_load_rm_signals': False, 'run_exp_data_tracking': False, 'run_gatekeeper': False, 'update_exp_borg_job_topic': '/pubsub2/test/ephemeral:livegraph-update-exp-borg-job-solma-nov21-d-side_a', 'run_as_datacanary': False, 'run_geo_loader_validator': False, 'run_borgmon': False, 'geo_loader_livegraph_publisher_topic': '', 'epoch_notification_topic': '/pubsub2/test/ephemeral:livegraph-epoch-complete-solma-nov21-d-side_a', 'run_pinax_repair': False, 'input_goops_topic': '/pubsub2/test/livegraph-input:solma-nov21-d', 'livegraph_output_topic_suffix': 'solma-nov21-d-side_a', 'run_loader': False, 'run_geo_loader': False, 'run_table_stats': False, 'input_environment': 'solma-nov21-d', 'source_data_base_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source', 'run_election': False, 'instance_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a', 'batch_input_goops_topic': '/pubsub2/test/livegraph-batch-input:solma-nov21-d-side_a', 'geo_loader_livegraph_publisher_realtime_topic': '', 'deadline_days': 1, 'canary_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary-canary', 'run_exp_validators': False, 'run_promote_mid': False, 'include_batch_monitor': False, 'unified_exp_loader_topic': '/pubsub2/test/ephemeral:livegraph-input-mini-expt-solma-nov21-d-side_a', 'pinax_cluster_full': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'prod_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary', 'allow_experiments': False}}, 'is_prod': False}"
  assert diff(new_handler_get_mini, new_borgcfg_get_mini, print_result=True)
  assert diff(borgcfg_get_mini, handler_get_mini, print_result=True)
  assert diff(borgcfg_get_mini, new_borgcfg_get_mini, print_result=True)

  # self.GetMini() # in requires_pinax_cluster.py
  requires_pinax_mixin_get_mini = "{'default_binary_ref': '@none', 'cell': 'qf', 'input_environment_var': 'input_environment', 'required_files': {'global_pinax_cluster': None, 'source_data_checkpoint_file': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source_data_checkpoint', 'user': 'livegraph-dev'}, 'exp_source_data_checkpoint_file': None}, 'mpm_version': 'test_mpm_108351659__c_opt_9aa02bd4', 'pubsub_subscribers': {'client_input': {'id': 'livegraph_dev_sub:solma-nov21-d-side_a', 'topics': '/pubsub2/test/livegraph-input:solma-nov21-d-side_a'}}, 'environment_var': 'instance', 'required_pinax_cluster': {'user': 'livegraph-dev', 'clear_production_fields': True, 'schema': '/tmp/mini-repo-3c5b546b8bf1695b5a7c8090700972c886f369d2/google3/livegraph_concrete.schema', 'bt_cell': 'qf-i-shared', 'schema_template_substitution_map': {'partition': 'default', 'data_fs_root_id': 0, 'bt_cell': None, 'table_writers': ['chubby!mdb/livegraph-dev'], 'table_administrator': 'chubby!mdb/livegraph-dev', 'write_only_fs_root_id': 0, 'table_owner': 'chubby!mdb/livegraph-dev'}, 'bt_prefix': 'livegraph-dev.solma-nov21-d-side_a.pinax', 'schema_mpm': {'filegroups': 'data', 'version': 'test_mpm_108351659__c_opt_9aa02bd4', 'pkg_name': 'knowledge/graph/livegraph'}, 'setschema_show_diff': False, 'partition': 'default', 'writers': ['chubby!mdb/livegraph-dev'], 'administrators': 'chubby!mdb/livegraph-dev', 'metadata_dir': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'die_after_days': 1, 'default_owner_as_user': False}, 'handler': 'mini.handler.Livegraph', 'worker_job_name': 'livegraph-solma-nov21-d-side_a.workers', 'build_targets': {'pinax_package': {'target': 'knowledge/graph/livegraph:pinax_mpm', 'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'mpm_label_var': 'mpm_version', 'mpm_label_prefix': 'test_'}, 'livegraph_package': {'target': 'knowledge/graph/livegraph:livegraph_mpm', 'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'mpm_label_var': 'mpm_version', 'mpm_label_prefix': 'test_'}, 'livegraph_monitoring_package': {'target': 'knowledge/graph/livegraph:livegraph_monitoring_mpm', 'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'mpm_label_var': 'mpm_version', 'mpm_label_prefix': 'test_'}, 'livegraph_release_tools_package': None, 'gatekeeper_package': None, 'livegraph_config_package': {'target': 'knowledge/graph/livegraph:livegraph_config_mpm', 'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'mpm_label_var': 'config_mpm_version', 'mpm_label_prefix': 'test_'}}, 'deadline_days': 1, 'user_var': 'user', 'init_tablet_split': {'run': False, 'mpm': {'file_name': 'init-tablet-split', 'version': 'test_mpm_108351659__c_opt_9aa02bd4', 'pkg': 'knowledge/graph/livegraph/tools/release-tools'}}, 'livegraph_required_pinax_cluster': {'user': 'livegraph-dev', 'clear_production_fields': True, 'schema': '/tmp/mini-repo-3c5b546b8bf1695b5a7c8090700972c886f369d2/google3/livegraph_concrete.schema', 'bt_cell': 'qf-i-shared', 'schema_template_substitution_map': {'partition': 'default', 'data_fs_root_id': 0, 'bt_cell': None, 'table_writers': ['chubby!mdb/livegraph-dev'], 'table_administrator': 'chubby!mdb/livegraph-dev', 'write_only_fs_root_id': 0, 'table_owner': 'chubby!mdb/livegraph-dev'}, 'bt_prefix': 'livegraph-dev.solma-nov21-d-side_a.pinax', 'schema_mpm': {'filegroups': 'data', 'version': 'test_mpm_108351659__c_opt_9aa02bd4', 'pkg_name': 'knowledge/graph/livegraph'}, 'setschema_show_diff': False, 'partition': 'default', 'writers': ['chubby!mdb/livegraph-dev'], 'administrators': 'chubby!mdb/livegraph-dev', 'metadata_dir': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'die_after_days': 1, 'default_owner_as_user': False}, 'required_directories': {'kg_schema_root_dir': {'name': '/namespace/livegraph/global/schema/ttl=30d', 'delete_on_purge': False, 'user': 'livegraph-dev'}, 'validators_base_dir': None, 'flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/flagfiles', 'user': 'livegraph-dev'}, 'gc_record_working_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/gc/ttl=7d', 'user': 'livegraph-dev'}, 'gatekeeper_base_dir': None, 'event_log_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/event-logs/ttl=7d', 'user': 'livegraph-dev'}, 'prewrite_cleaner_flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/prewrite_cleaner', 'user': 'livegraph-dev'}, 'exp_source_data_basedir': None, 'instance_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a', 'user': 'livegraph-dev'}, 'mr_table_stats_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/mr-table-stats-logs/ttl=7d', 'user': 'livegraph-dev'}, 'source_data_basedir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source', 'delete_on_purge': True, 'user': 'livegraph-dev'}}, 'mpm_extra_label': None, 'user': 'livegraph-dev', 'livegraph_log_info': {'sorted': True, 'key_values': {'loading_tags': 'mini', 'use_large_experiments_topic': False, 'topic_server_epoch_completion_topic': '/pubsub2/test/ephemeral:topicserver-epoch-complete-solma-nov21-d-side_a', 'livegraph_output_topic_prefix': '', 'kg_schema_root_dir': '/namespace/livegraph/global/schema/ttl=30d', 'disable_client_subscriber_topics': False, 'run_load_rm_signals': False, 'run_exp_data_tracking': False, 'run_gatekeeper': False, 'update_exp_borg_job_topic': '/pubsub2/test/ephemeral:livegraph-update-exp-borg-job-solma-nov21-d-side_a', 'run_as_datacanary': False, 'run_geo_loader_validator': False, 'run_borgmon': False, 'geo_loader_livegraph_publisher_topic': '', 'epoch_notification_topic': '/pubsub2/test/ephemeral:livegraph-epoch-complete-solma-nov21-d-side_a', 'run_pinax_repair': False, 'input_goops_topic': '/pubsub2/test/livegraph-input:solma-nov21-d', 'livegraph_output_topic_suffix': 'solma-nov21-d-side_a', 'run_loader': False, 'run_geo_loader': False, 'run_table_stats': False, 'input_environment': 'solma-nov21-d', 'source_data_base_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source', 'run_election': False, 'instance_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a', 'batch_input_goops_topic': '/pubsub2/test/livegraph-batch-input:solma-nov21-d-side_a', 'geo_loader_livegraph_publisher_realtime_topic': '', 'deadline_days': 1, 'canary_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary-canary', 'run_exp_validators': False, 'run_promote_mid': False, 'include_batch_monitor': False, 'unified_exp_loader_topic': '/pubsub2/test/ephemeral:livegraph-input-mini-expt-solma-nov21-d-side_a', 'pinax_cluster_full': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'prod_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary', 'allow_experiments': False}}, 'is_prod': False}"
  # self.BorgCfg().GetMini() # in requires_pinax_cluster.py
  requires_pinax_mixin_borgcfg_get_mini = "{'default_binary_ref': '@none', 'cell': 'qf', 'input_environment_var': 'input_environment', 'required_files': {'global_pinax_cluster': None, 'source_data_checkpoint_file': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source_data_checkpoint', 'user': 'livegraph-dev'}, 'exp_source_data_checkpoint_file': None}, 'mpm_version': 'test_mpm_108351659__c_opt_9aa02bd4', 'pubsub_subscribers': {'client_input': {'id': 'livegraph_dev_sub:solma-nov21-d-side_a', 'topics': '/pubsub2/test/livegraph-input:solma-nov21-d-side_a'}}, 'environment_var': 'instance', 'required_pinax_cluster': {'user': 'livegraph-dev', 'clear_production_fields': True, 'schema': '/tmp/mini-repo-3c5b546b8bf1695b5a7c8090700972c886f369d2/google3/livegraph_concrete.schema', 'bt_cell': 'qf-i-shared', 'schema_template_substitution_map': {'partition': 'default', 'data_fs_root_id': 0, 'bt_cell': None, 'table_writers': ['chubby!mdb/livegraph-dev'], 'table_administrator': 'chubby!mdb/livegraph-dev', 'write_only_fs_root_id': 0, 'table_owner': 'chubby!mdb/livegraph-dev'}, 'bt_prefix': 'livegraph-dev.solma-nov21-d-side_a.pinax', 'schema_mpm': {'filegroups': 'data', 'version': 'test_mpm_108351659__c_opt_9aa02bd4', 'pkg_name': 'knowledge/graph/livegraph'}, 'setschema_show_diff': False, 'partition': 'default', 'writers': ['chubby!mdb/livegraph-dev'], 'administrators': 'chubby!mdb/livegraph-dev', 'metadata_dir': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'die_after_days': 1, 'default_owner_as_user': False}, 'handler': 'mini.handler.Livegraph', 'worker_job_name': 'livegraph-solma-nov21-d-side_a.workers', 'build_targets': {'pinax_package': {'target': 'knowledge/graph/livegraph:pinax_mpm', 'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'mpm_label_var': 'mpm_version', 'mpm_label_prefix': 'test_'}, 'livegraph_package': {'target': 'knowledge/graph/livegraph:livegraph_mpm', 'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'mpm_label_var': 'mpm_version', 'mpm_label_prefix': 'test_'}, 'livegraph_monitoring_package': {'target': 'knowledge/graph/livegraph:livegraph_monitoring_mpm', 'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'mpm_label_var': 'mpm_version', 'mpm_label_prefix': 'test_'}, 'livegraph_release_tools_package': None, 'gatekeeper_package': None, 'livegraph_config_package': {'target': 'knowledge/graph/livegraph:livegraph_config_mpm', 'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'mpm_label_var': 'config_mpm_version', 'mpm_label_prefix': 'test_'}}, 'deadline_days': 1, 'user_var': 'user', 'init_tablet_split': {'run': False, 'mpm': {'file_name': 'init-tablet-split', 'version': 'test_mpm_108351659__c_opt_9aa02bd4', 'pkg': 'knowledge/graph/livegraph/tools/release-tools'}}, 'livegraph_required_pinax_cluster': {'user': 'livegraph-dev', 'clear_production_fields': True, 'schema': '/tmp/mini-repo-3c5b546b8bf1695b5a7c8090700972c886f369d2/google3/livegraph_concrete.schema', 'bt_cell': 'qf-i-shared', 'schema_template_substitution_map': {'partition': 'default', 'data_fs_root_id': 0, 'bt_cell': None, 'table_writers': ['chubby!mdb/livegraph-dev'], 'table_administrator': 'chubby!mdb/livegraph-dev', 'write_only_fs_root_id': 0, 'table_owner': 'chubby!mdb/livegraph-dev'}, 'bt_prefix': 'livegraph-dev.solma-nov21-d-side_a.pinax', 'schema_mpm': {'filegroups': 'data', 'version': 'test_mpm_108351659__c_opt_9aa02bd4', 'pkg_name': 'knowledge/graph/livegraph'}, 'setschema_show_diff': False, 'partition': 'default', 'writers': ['chubby!mdb/livegraph-dev'], 'administrators': 'chubby!mdb/livegraph-dev', 'metadata_dir': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'die_after_days': 1, 'default_owner_as_user': False}, 'required_directories': {'kg_schema_root_dir': {'name': '/namespace/livegraph/global/schema/ttl=30d', 'delete_on_purge': False, 'user': 'livegraph-dev'}, 'validators_base_dir': None, 'flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/flagfiles', 'user': 'livegraph-dev'}, 'gc_record_working_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/gc/ttl=7d', 'user': 'livegraph-dev'}, 'gatekeeper_base_dir': None, 'event_log_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/event-logs/ttl=7d', 'user': 'livegraph-dev'}, 'prewrite_cleaner_flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/prewrite_cleaner', 'user': 'livegraph-dev'}, 'exp_source_data_basedir': None, 'instance_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a', 'user': 'livegraph-dev'}, 'mr_table_stats_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/mr-table-stats-logs/ttl=7d', 'user': 'livegraph-dev'}, 'source_data_basedir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source', 'delete_on_purge': True, 'user': 'livegraph-dev'}}, 'mpm_extra_label': None, 'user': 'livegraph-dev', 'livegraph_log_info': {'sorted': True, 'key_values': {'loading_tags': 'mini', 'use_large_experiments_topic': False, 'topic_server_epoch_completion_topic': '/pubsub2/test/ephemeral:topicserver-epoch-complete-solma-nov21-d-side_a', 'livegraph_output_topic_prefix': '', 'kg_schema_root_dir': '/namespace/livegraph/global/schema/ttl=30d', 'disable_client_subscriber_topics': False, 'run_load_rm_signals': False, 'run_exp_data_tracking': False, 'run_gatekeeper': False, 'update_exp_borg_job_topic': '/pubsub2/test/ephemeral:livegraph-update-exp-borg-job-solma-nov21-d-side_a', 'run_as_datacanary': False, 'run_geo_loader_validator': False, 'run_borgmon': False, 'geo_loader_livegraph_publisher_topic': '', 'epoch_notification_topic': '/pubsub2/test/ephemeral:livegraph-epoch-complete-solma-nov21-d-side_a', 'run_pinax_repair': False, 'input_goops_topic': '/pubsub2/test/livegraph-input:solma-nov21-d', 'livegraph_output_topic_suffix': 'solma-nov21-d-side_a', 'run_loader': False, 'run_geo_loader': False, 'run_table_stats': False, 'input_environment': 'solma-nov21-d', 'source_data_base_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source', 'run_election': False, 'instance_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a', 'batch_input_goops_topic': '/pubsub2/test/livegraph-batch-input:solma-nov21-d-side_a', 'geo_loader_livegraph_publisher_realtime_topic': '', 'deadline_days': 1, 'canary_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary-canary', 'run_exp_validators': False, 'run_promote_mid': False, 'include_batch_monitor': False, 'unified_exp_loader_topic': '/pubsub2/test/ephemeral:livegraph-input-mini-expt-solma-nov21-d-side_a', 'pinax_cluster_full': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'prod_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary', 'allow_experiments': False}}, 'is_prod': False}"
  assert diff(requires_pinax_mixin_get_mini, requires_pinax_mixin_borgcfg_get_mini, print_result=True)

  tmp="{'worker_job_name': 'livegraph-solma-nov21-d-side_a.workers', 'init_tablet_split': {'run': False, 'mpm': {'file_name': 'init-tablet-split', 'pkg': 'knowledge/graph/livegraph/tools/release-tools', 'version': 'test_mpm_108351659__c_opt_9aa02bd4'}}, 'default_binary_ref': '@none', 'livegraph_required_pinax_cluster': {'clear_production_fields': True, 'partition': 'default', 'writers': ['chubby!mdb/livegraph-dev'], 'administrators': 'chubby!mdb/livegraph-dev', 'setschema_show_diff': False, 'default_owner_as_user': False, 'schema_template_substitution_map': {'write_only_fs_root_id': 0, 'table_writers': ['chubby!mdb/livegraph-dev'], 'table_owner': 'chubby!mdb/livegraph-dev', 'partition': 'default', 'data_fs_root_id': 0, 'table_administrator': 'chubby!mdb/livegraph-dev', 'bt_cell': None}, 'schema': '/tmp/mini-repo-3c5b546b8bf1695b5a7c8090700972c886f369d2/google3/livegraph_concrete.schema', 'bt_prefix': 'livegraph-dev.solma-nov21-d-side_a.pinax', 'die_after_days': 1, 'metadata_dir': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'bt_cell': 'qf-i-shared', 'user': 'livegraph-dev', 'schema_mpm': {'filegroups': 'data', 'pkg_name': 'knowledge/graph/livegraph', 'version': 'test_mpm_108351659__c_opt_9aa02bd4'}}, 'required_directories': {'exp_source_data_basedir': None, 'flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/flagfiles', 'user': 'livegraph-dev'}, 'instance_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a', 'user': 'livegraph-dev'}, 'source_data_basedir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source', 'delete_on_purge': True, 'user': 'livegraph-dev'}, 'kg_schema_root_dir': {'name': '/namespace/livegraph/global/schema/ttl=30d', 'delete_on_purge': False, 'user': 'livegraph-dev'}, 'gc_record_working_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/gc/ttl=7d', 'user': 'livegraph-dev'}, 'validators_base_dir': None, 'event_log_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/event-logs/ttl=7d', 'user': 'livegraph-dev'}, 'gatekeeper_base_dir': None, 'mr_table_stats_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/mr-table-stats-logs/ttl=7d', 'user': 'livegraph-dev'}, 'prewrite_cleaner_flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/prewrite_cleaner', 'user': 'livegraph-dev'}}, 'required_files': {'global_pinax_cluster': None, 'source_data_checkpoint_file': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source_data_checkpoint', 'user': 'livegraph-dev'}, 'exp_source_data_checkpoint_file': None}, 'build_targets': {'livegraph_package': {'mpm_label_var': 'mpm_version', 'target': 'knowledge/graph/livegraph:livegraph_mpm', 'mpm_label_prefix': 'test_', 'build_options': {'durability': '--mpm_build_arg=--durability=TEST', 'extra_label': None}}, 'livegraph_monitoring_package': {'mpm_label_var': 'mpm_version', 'target': 'knowledge/graph/livegraph:livegraph_monitoring_mpm', 'mpm_label_prefix': 'test_', 'build_options': {'durability': '--mpm_build_arg=--durability=TEST', 'extra_label': None}}, 'pinax_package': {'mpm_label_var': 'mpm_version', 'target': 'knowledge/graph/livegraph:pinax_mpm', 'mpm_label_prefix': 'test_', 'build_options': {'durability': '--mpm_build_arg=--durability=TEST', 'extra_label': None}}, 'livegraph_config_package': {'mpm_label_var': 'config_mpm_version', 'target': 'knowledge/graph/livegraph:livegraph_config_mpm', 'mpm_label_prefix': 'test_', 'build_options': {'durability': '--mpm_build_arg=--durability=TEST', 'extra_label': None}}, 'livegraph_release_tools_package': None, 'gatekeeper_package': None}, 'mpm_extra_label': None, 'pubsub_subscribers': {'client_input': {'topics': '/pubsub2/test/livegraph-input:solma-nov21-d-side_a', 'id': 'livegraph_dev_sub:solma-nov21-d-side_a'}}, 'handler': 'mini.handler.Livegraph', 'livegraph_log_info': {'key_values': {'disable_client_subscriber_topics': False, 'source_data_base_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source', 'geo_loader_livegraph_publisher_topic': '', 'run_loader': False, 'loading_tags': 'mini', 'use_large_experiments_topic': False, 'pinax_cluster_full': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'run_geo_loader_validator': False, 'canary_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary-canary', 'instance_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a', 'run_gatekeeper': False, 'include_batch_monitor': False, 'run_geo_loader': False, 'geo_loader_livegraph_publisher_realtime_topic': '', 'run_exp_validators': False, 'run_borgmon': False, 'deadline_days': 1, 'livegraph_output_topic_suffix': 'solma-nov21-d-side_a', 'prod_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary', 'topic_server_epoch_completion_topic': '/pubsub2/test/ephemeral:topicserver-epoch-complete-solma-nov21-d-side_a', 'kg_schema_root_dir': '/namespace/livegraph/global/schema/ttl=30d', 'livegraph_output_topic_prefix': '', 'epoch_notification_topic': '/pubsub2/test/ephemeral:livegraph-epoch-complete-solma-nov21-d-side_a', 'update_exp_borg_job_topic': '/pubsub2/test/ephemeral:livegraph-update-exp-borg-job-solma-nov21-d-side_a', 'run_election': False, 'run_pinax_repair': False, 'input_environment': 'solma-nov21-d', 'unified_exp_loader_topic': '/pubsub2/test/ephemeral:livegraph-input-mini-expt-solma-nov21-d-side_a', 'run_table_stats': False, 'run_promote_mid': False, 'run_load_rm_signals': False, 'batch_input_goops_topic': '/pubsub2/test/livegraph-batch-input:solma-nov21-d-side_a', 'allow_experiments': False, 'run_as_datacanary': False, 'input_goops_topic': '/pubsub2/test/livegraph-input:solma-nov21-d', 'run_exp_data_tracking': False}, 'sorted': True}, 'required_pinax_cluster': {'clear_production_fields': True, 'partition': 'default', 'writers': ['chubby!mdb/livegraph-dev'], 'administrators': 'chubby!mdb/livegraph-dev', 'setschema_show_diff': False, 'default_owner_as_user': False, 'schema_template_substitution_map': {'write_only_fs_root_id': 0, 'table_writers': ['chubby!mdb/livegraph-dev'], 'table_owner': 'chubby!mdb/livegraph-dev', 'partition': 'default', 'data_fs_root_id': 0, 'table_administrator': 'chubby!mdb/livegraph-dev', 'bt_cell': None}, 'schema': '/tmp/mini-repo-3c5b546b8bf1695b5a7c8090700972c886f369d2/google3/livegraph_concrete.schema', 'bt_prefix': 'livegraph-dev.solma-nov21-d-side_a.pinax', 'die_after_days': 1, 'metadata_dir': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'bt_cell': 'qf-i-shared', 'user': 'livegraph-dev', 'schema_mpm': {'filegroups': 'data', 'pkg_name': 'knowledge/graph/livegraph', 'version': 'test_mpm_108351659__c_opt_9aa02bd4'}}, 'environment_var': 'instance', 'is_prod': False, 'input_environment_var': 'input_environment', 'user_var': 'user', 'deadline_days': 1, 'user': 'livegraph-dev', 'cell': 'qf', 'mpm_version': 'test_mpm_108351659__c_opt_9aa02bd4'}"
  diff(borgcfg_get_mini, tmp, print_result=False)


  # # handler.Environment().GetBorgCfgByBorgFile(self.BorgCfg().BorgFile(),borgcfg_mini_vars=self.BorgCfg()._borgcfg_mini_vars).GetMini()
  # new_borgcfg_with_borgcfg_mini_var_get_mini = "{'build_targets': {'livegraph_package': {'build_options': {" \
  #                                           "'extra_label': None, " \
  #                         "'durability': '--mpm_build_arg=--durability=TEST'}, 'target': 'knowledge/graph/livegraph:livegraph_mpm', 'mpm_label_prefix': 'test_', 'mpm_label_var': 'mpm_version'}, 'livegraph_monitoring_package': {'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'target': 'knowledge/graph/livegraph:livegraph_monitoring_mpm', 'mpm_label_prefix': 'test_', 'mpm_label_var': 'mpm_version'}, 'gatekeeper_package': None, 'livegraph_config_package': {'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'target': 'knowledge/graph/livegraph:livegraph_config_mpm', 'mpm_label_prefix': 'test_', 'mpm_label_var': 'config_mpm_version'}, 'pinax_package': {'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'target': 'knowledge/graph/livegraph:pinax_mpm', 'mpm_label_prefix': 'test_', 'mpm_label_var': 'mpm_version'}, 'livegraph_release_tools_package': None}, 'pubsub_subscribers': {'client_input': {'id': 'livegraph_dev_sub:solma-nov21-d-side_a', 'topics': '/pubsub2/test/livegraph-input:solma-nov21-d-side_a'}}, 'required_files': {'global_pinax_cluster': None, 'exp_source_data_checkpoint_file': None, 'source_data_checkpoint_file': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source_data_checkpoint', 'user': 'livegraph-dev'}}, 'handler': 'mini.handler.Livegraph', 'worker_job_name': 'livegraph-solma-nov21-d-side_a.workers', 'mpm_extra_label': None, 'default_binary_ref': '@none', 'user_var': 'user', 'cell': 'qf', 'required_directories': {'event_log_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/event-logs/ttl=7d', 'user': 'livegraph-dev'}, 'prewrite_cleaner_flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/prewrite_cleaner', 'user': 'livegraph-dev'}, 'exp_source_data_basedir': None, 'source_data_basedir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source', 'delete_on_purge': True, 'user': 'livegraph-dev'}, 'instance_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a', 'user': 'livegraph-dev'}, 'flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/flagfiles', 'user': 'livegraph-dev'}, 'gatekeeper_base_dir': None, 'validators_base_dir': None, 'mr_table_stats_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/mr-table-stats-logs/ttl=7d', 'user': 'livegraph-dev'}, 'gc_record_working_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/gc/ttl=7d', 'user': 'livegraph-dev'}, 'kg_schema_root_dir': {'name': '/namespace/livegraph/global/schema/ttl=30d', 'delete_on_purge': False, 'user': 'livegraph-dev'}}, 'deadline_days': 1, 'init_tablet_split': {'mpm': {'version': 'test_mpm_108351659__c_opt_9aa02bd4', 'file_name': 'init-tablet-split', 'pkg': 'knowledge/graph/livegraph/tools/release-tools'}, 'run': False}, 'livegraph_log_info': {'sorted': True, 'key_values': {'use_large_experiments_topic': False, 'run_loader': False, 'batch_input_goops_topic': '/pubsub2/test/livegraph-batch-input:solma-nov21-d-side_a', 'allow_experiments': False, 'topic_server_epoch_completion_topic': '/pubsub2/test/ephemeral:topicserver-epoch-complete-solma-nov21-d-side_a', 'disable_client_subscriber_topics': False, 'run_gatekeeper': False, 'deadline_days': 1, 'unified_exp_loader_topic': '/pubsub2/test/ephemeral:livegraph-input-mini-expt-solma-nov21-d-side_a', 'pinax_cluster_full': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'source_data_base_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source', 'run_load_rm_signals': False, 'canary_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary-canary', 'geo_loader_livegraph_publisher_topic': '', 'livegraph_output_topic_suffix': 'solma-nov21-d-side_a', 'run_exp_validators': False, 'livegraph_output_topic_prefix': '', 'epoch_notification_topic': '/pubsub2/test/ephemeral:livegraph-epoch-complete-solma-nov21-d-side_a', 'geo_loader_livegraph_publisher_realtime_topic': '', 'input_environment': 'solma-nov21-d', 'run_as_datacanary': False, 'run_geo_loader': False, 'run_election': False, 'loading_tags': 'mini', 'update_exp_borg_job_topic': '/pubsub2/test/ephemeral:livegraph-update-exp-borg-job-solma-nov21-d-side_a', 'input_goops_topic': '/pubsub2/test/livegraph-input:solma-nov21-d', 'run_exp_data_tracking': False, 'run_promote_mid': False, 'include_batch_monitor': False, 'run_table_stats': False, 'run_geo_loader_validator': False, 'run_borgmon': False, 'instance_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a', 'prod_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary', 'run_pinax_repair': False, 'kg_schema_root_dir': '/namespace/livegraph/global/schema/ttl=30d'}}, 'input_environment_var': 'input_environment', 'environment_var': 'instance', 'mpm_version': 'test_mpm_108351659__c_opt_9aa02bd4', 'is_prod': False, 'livegraph_required_pinax_cluster': {'die_after_days': 1, 'setschema_show_diff': False, 'schema_mpm': {'version': 'test_mpm_108351659__c_opt_9aa02bd4', 'filegroups': 'data', 'pkg_name': 'knowledge/graph/livegraph'}, 'clear_production_fields': True, 'schema': 'knowledge/graph/livegraph/storage/livegraph.schema.template', 'bt_prefix': 'livegraph-dev.solma-nov21-d-side_a.pinax', 'partition': 'default', 'metadata_dir': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'administrators': 'chubby!mdb/livegraph-dev', 'default_owner_as_user': False, 'bt_cell': 'qf-i-shared', 'writers': ['chubby!mdb/livegraph-dev'], 'schema_template_substitution_map': {'partition': 'default', 'table_writers': ['chubby!mdb/livegraph-dev'], 'table_administrator': 'chubby!mdb/livegraph-dev', 'table_owner': 'chubby!mdb/livegraph-dev', 'write_only_fs_root_id': 0, 'bt_cell': None, 'data_fs_root_id': 0}, 'user': 'livegraph-dev'}, 'user': 'livegraph-dev'}"
  # #self.Environment().GetBorgCfgByBorgFile(self.BorgCfg().BorgFile(),borgcfg_vars=self.BorgCfg()._borgcfg_vars)).GetMini()
  # new_borgcfg_with_borgcfg_var_get_mini = "{'build_targets': {'livegraph_package': {'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'target': 'knowledge/graph/livegraph:livegraph_mpm', 'mpm_label_prefix': 'test_', 'mpm_label_var': 'mpm_version'}, 'livegraph_monitoring_package': {'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'target': 'knowledge/graph/livegraph:livegraph_monitoring_mpm', 'mpm_label_prefix': 'test_', 'mpm_label_var': 'mpm_version'}, 'gatekeeper_package': None, 'livegraph_config_package': {'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'target': 'knowledge/graph/livegraph:livegraph_config_mpm', 'mpm_label_prefix': 'test_', 'mpm_label_var': 'config_mpm_version'}, 'pinax_package': {'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'target': 'knowledge/graph/livegraph:pinax_mpm', 'mpm_label_prefix': 'test_', 'mpm_label_var': 'mpm_version'}, 'livegraph_release_tools_package': None}, 'pubsub_subscribers': {'client_input': {'id': 'livegraph_dev_sub:solma-default', 'topics': '/pubsub2/test/livegraph-input:solma-default'}}, 'required_files': {'global_pinax_cluster': None, 'exp_source_data_checkpoint_file': None, 'source_data_checkpoint_file': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-default/source_data_checkpoint', 'user': 'livegraph-dev'}}, 'handler': 'mini.handler.Livegraph', 'worker_job_name': 'livegraph-solma-default.workers', 'mpm_extra_label': None, 'default_binary_ref': '@config_ref', 'user_var': 'user', 'cell': 'qf', 'required_directories': {'event_log_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-default/event-logs/ttl=7d', 'user': 'livegraph-dev'}, 'prewrite_cleaner_flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-default/prewrite_cleaner', 'user': 'livegraph-dev'}, 'exp_source_data_basedir': None, 'source_data_basedir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-default/source', 'delete_on_purge': True, 'user': 'livegraph-dev'}, 'instance_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-default', 'user': 'livegraph-dev'}, 'flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-default/flagfiles', 'user': 'livegraph-dev'}, 'gatekeeper_base_dir': None, 'validators_base_dir': None, 'mr_table_stats_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-default/mr-table-stats-logs/ttl=7d', 'user': 'livegraph-dev'}, 'gc_record_working_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-default/gc/ttl=7d', 'user': 'livegraph-dev'}, 'kg_schema_root_dir': {'name': '/namespace/livegraph/global/schema/ttl=30d', 'delete_on_purge': False, 'user': 'livegraph-dev'}}, 'deadline_days': 1, 'init_tablet_split': {'mpm': {'version': None, 'file_name': 'init-tablet-split', 'pkg': 'knowledge/graph/livegraph/tools/release-tools'}, 'run': False}, 'livegraph_log_info': {'sorted': True, 'key_values': {'use_large_experiments_topic': False, 'run_loader': False, 'batch_input_goops_topic': '/pubsub2/test/livegraph-batch-input:solma-default', 'allow_experiments': False, 'topic_server_epoch_completion_topic': '/pubsub2/test/ephemeral:topicserver-epoch-complete-solma-default', 'disable_client_subscriber_topics': False, 'run_gatekeeper': False, 'deadline_days': 1, 'unified_exp_loader_topic': '/pubsub2/test/ephemeral:livegraph-input-mini-expt-solma-default', 'pinax_cluster_full': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'source_data_base_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-default/source', 'run_load_rm_signals': False, 'canary_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary-canary', 'geo_loader_livegraph_publisher_topic': '', 'livegraph_output_topic_suffix': 'solma-default', 'run_exp_validators': False, 'livegraph_output_topic_prefix': '', 'epoch_notification_topic': '/pubsub2/test/ephemeral:livegraph-epoch-complete-solma-default', 'geo_loader_livegraph_publisher_realtime_topic': '', 'input_environment': 'solma-nov21-d', 'run_as_datacanary': False, 'run_geo_loader': False, 'run_election': False, 'loading_tags': 'mini', 'update_exp_borg_job_topic': '/pubsub2/test/ephemeral:livegraph-update-exp-borg-job-solma-default', 'input_goops_topic': '/pubsub2/test/livegraph-input:solma-nov21-d', 'run_exp_data_tracking': False, 'run_promote_mid': False, 'include_batch_monitor': False, 'run_table_stats': False, 'run_geo_loader_validator': False, 'run_borgmon': False, 'instance_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-default', 'prod_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary', 'run_pinax_repair': False, 'kg_schema_root_dir': '/namespace/livegraph/global/schema/ttl=30d'}}, 'input_environment_var': 'input_environment', 'environment_var': 'instance', 'mpm_version': None, 'is_prod': False, 'livegraph_required_pinax_cluster': {'die_after_days': 1, 'setschema_show_diff': False, 'schema_mpm': {'version': None, 'filegroups': 'data', 'pkg_name': 'knowledge/graph/livegraph'}, 'clear_production_fields': True, 'schema': 'knowledge/graph/livegraph/storage/livegraph.schema.template', 'bt_prefix': 'livegraph-dev.solma-default.pinax', 'partition': 'default', 'metadata_dir': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'administrators': 'chubby!mdb/livegraph-dev', 'default_owner_as_user': False, 'bt_cell': 'qf-i-shared', 'writers': ['chubby!mdb/livegraph-dev'], 'schema_template_substitution_map': {'partition': 'default', 'table_writers': ['chubby!mdb/livegraph-dev'], 'table_administrator': 'chubby!mdb/livegraph-dev', 'table_owner': 'chubby!mdb/livegraph-dev', 'write_only_fs_root_id': 0, 'bt_cell': None, 'data_fs_root_id': 0}, 'user': 'livegraph-dev'}, 'user': 'livegraph-dev'}"
  #
  # diff(borgcfg_get_mini, new_borgcfg_with_borgcfg_var_get_mini, print_result=False)
  #
  #
  # # self.Environment()._GetHandlerFactoryByRef('mini.handler.Livegraph')(self.BorgCfg().BorgFile(), self.Environment(), borgcfg_vars=dict(self.BorgCfg()._borgcfg_vars), two_pass_borgcfg_parsing=False).GetMini()
  # new_handler_borgcfg_vars_again = "{'build_targets': {'livegraph_package': {'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'target': 'knowledge/graph/livegraph:livegraph_mpm', 'mpm_label_prefix': 'test_', 'mpm_label_var': 'mpm_version'}, 'livegraph_monitoring_package': {'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'target': 'knowledge/graph/livegraph:livegraph_monitoring_mpm', 'mpm_label_prefix': 'test_', 'mpm_label_var': 'mpm_version'}, 'gatekeeper_package': None, 'livegraph_config_package': {'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'target': 'knowledge/graph/livegraph:livegraph_config_mpm', 'mpm_label_prefix': 'test_', 'mpm_label_var': 'config_mpm_version'}, 'pinax_package': {'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'target': 'knowledge/graph/livegraph:pinax_mpm', 'mpm_label_prefix': 'test_', 'mpm_label_var': 'mpm_version'}, 'livegraph_release_tools_package': None}, 'pubsub_subscribers': {'client_input': {'id': 'livegraph_dev_sub:solma-nov21-d-side_a', 'topics': '/pubsub2/test/livegraph-input:solma-nov21-d-side_a'}}, 'required_files': {'global_pinax_cluster': None, 'exp_source_data_checkpoint_file': None, 'source_data_checkpoint_file': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source_data_checkpoint', 'user': 'livegraph-dev'}}, 'handler': 'mini.handler.Livegraph', 'worker_job_name': 'livegraph-solma-nov21-d-side_a.workers', 'mpm_extra_label': None, 'default_binary_ref': '@none', 'user_var': 'user', 'cell': 'qf', 'required_directories': {'event_log_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/event-logs/ttl=7d', 'user': 'livegraph-dev'}, 'prewrite_cleaner_flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/prewrite_cleaner', 'user': 'livegraph-dev'}, 'exp_source_data_basedir': None, 'source_data_basedir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source', 'delete_on_purge': True, 'user': 'livegraph-dev'}, 'instance_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a', 'user': 'livegraph-dev'}, 'flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/flagfiles', 'user': 'livegraph-dev'}, 'gatekeeper_base_dir': None, 'validators_base_dir': None, 'mr_table_stats_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/mr-table-stats-logs/ttl=7d', 'user': 'livegraph-dev'}, 'gc_record_working_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/gc/ttl=7d', 'user': 'livegraph-dev'}, 'kg_schema_root_dir': {'name': '/namespace/livegraph/global/schema/ttl=30d', 'delete_on_purge': False, 'user': 'livegraph-dev'}}, 'deadline_days': 1, 'init_tablet_split': {'mpm': {'version': 'test_mpm_108351659__c_opt_9aa02bd4', 'file_name': 'init-tablet-split', 'pkg': 'knowledge/graph/livegraph/tools/release-tools'}, 'run': False}, 'livegraph_log_info': {'sorted': True, 'key_values': {'use_large_experiments_topic': False, 'run_loader': False, 'batch_input_goops_topic': '/pubsub2/test/livegraph-batch-input:solma-nov21-d-side_a', 'allow_experiments': False, 'topic_server_epoch_completion_topic': '/pubsub2/test/ephemeral:topicserver-epoch-complete-solma-nov21-d-side_a', 'disable_client_subscriber_topics': False, 'run_gatekeeper': False, 'deadline_days': 1, 'unified_exp_loader_topic': '/pubsub2/test/ephemeral:livegraph-input-mini-expt-solma-nov21-d-side_a', 'pinax_cluster_full': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'source_data_base_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source', 'run_load_rm_signals': False, 'canary_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary-canary', 'geo_loader_livegraph_publisher_topic': '', 'livegraph_output_topic_suffix': 'solma-nov21-d-side_a', 'run_exp_validators': False, 'livegraph_output_topic_prefix': '', 'epoch_notification_topic': '/pubsub2/test/ephemeral:livegraph-epoch-complete-solma-nov21-d-side_a', 'geo_loader_livegraph_publisher_realtime_topic': '', 'input_environment': 'solma-nov21-d', 'run_as_datacanary': False, 'run_geo_loader': False, 'run_election': False, 'loading_tags': 'mini', 'update_exp_borg_job_topic': '/pubsub2/test/ephemeral:livegraph-update-exp-borg-job-solma-nov21-d-side_a', 'input_goops_topic': '/pubsub2/test/livegraph-input:solma-nov21-d', 'run_exp_data_tracking': False, 'run_promote_mid': False, 'include_batch_monitor': False, 'run_table_stats': False, 'run_geo_loader_validator': False, 'run_borgmon': False, 'instance_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a', 'prod_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary', 'run_pinax_repair': False, 'kg_schema_root_dir': '/namespace/livegraph/global/schema/ttl=30d'}}, 'input_environment_var': 'input_environment', 'environment_var': 'instance', 'mpm_version': 'test_mpm_108351659__c_opt_9aa02bd4', 'is_prod': False, 'livegraph_required_pinax_cluster': {'die_after_days': 1, 'setschema_show_diff': False, 'schema_mpm': {'version': 'test_mpm_108351659__c_opt_9aa02bd4', 'filegroups': 'data', 'pkg_name': 'knowledge/graph/livegraph'}, 'clear_production_fields': True, 'schema': 'knowledge/graph/livegraph/storage/livegraph.schema.template', 'bt_prefix': 'livegraph-dev.solma-nov21-d-side_a.pinax', 'partition': 'default', 'metadata_dir': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'administrators': 'chubby!mdb/livegraph-dev', 'default_owner_as_user': False, 'bt_cell': 'qf-i-shared', 'writers': ['chubby!mdb/livegraph-dev'], 'schema_template_substitution_map': {'partition': 'default', 'table_writers': ['chubby!mdb/livegraph-dev'], 'table_administrator': 'chubby!mdb/livegraph-dev', 'table_owner': 'chubby!mdb/livegraph-dev', 'write_only_fs_root_id': 0, 'bt_cell': None, 'data_fs_root_id': 0}, 'user': 'livegraph-dev'}, 'user': 'livegraph-dev'}"
  # #diff(new_handler_borgcfg_vars, new_handler_borgcfg_vars_again, print_result=False)
  #
  # ag = ast.literal_eval("{'build_targets': {'livegraph_package': {'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'target': 'knowledge/graph/livegraph:livegraph_mpm', 'mpm_label_prefix': 'test_', 'mpm_label_var': 'mpm_version'}, 'livegraph_monitoring_package': {'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'target': 'knowledge/graph/livegraph:livegraph_monitoring_mpm', 'mpm_label_prefix': 'test_', 'mpm_label_var': 'mpm_version'}, 'gatekeeper_package': None, 'livegraph_config_package': {'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'target': 'knowledge/graph/livegraph:livegraph_config_mpm', 'mpm_label_prefix': 'test_', 'mpm_label_var': 'config_mpm_version'}, 'pinax_package': {'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'target': 'knowledge/graph/livegraph:pinax_mpm', 'mpm_label_prefix': 'test_', 'mpm_label_var': 'mpm_version'}, 'livegraph_release_tools_package': None}, 'pubsub_subscribers': {'client_input': {'id': 'livegraph_dev_sub:solma-nov21-d-side_a', 'topics': '/pubsub2/test/livegraph-input:solma-nov21-d-side_a'}}, 'required_files': {'global_pinax_cluster': None, 'exp_source_data_checkpoint_file': None, 'source_data_checkpoint_file': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source_data_checkpoint', 'user': 'livegraph-dev'}}, 'handler': 'mini.handler.Livegraph', 'worker_job_name': 'livegraph-solma-nov21-d-side_a.workers', 'mpm_extra_label': None, 'default_binary_ref': '@none', 'user_var': 'user', 'cell': 'qf', 'required_directories': {'event_log_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/event-logs/ttl=7d', 'user': 'livegraph-dev'}, 'prewrite_cleaner_flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/prewrite_cleaner', 'user': 'livegraph-dev'}, 'exp_source_data_basedir': None, 'source_data_basedir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source', 'delete_on_purge': True, 'user': 'livegraph-dev'}, 'instance_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a', 'user': 'livegraph-dev'}, 'flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/flagfiles', 'user': 'livegraph-dev'}, 'gatekeeper_base_dir': None, 'validators_base_dir': None, 'mr_table_stats_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/mr-table-stats-logs/ttl=7d', 'user': 'livegraph-dev'}, 'gc_record_working_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/gc/ttl=7d', 'user': 'livegraph-dev'}, 'kg_schema_root_dir': {'name': '/namespace/livegraph/global/schema/ttl=30d', 'delete_on_purge': False, 'user': 'livegraph-dev'}}, 'deadline_days': 1, 'init_tablet_split': {'mpm': {'version': 'test_mpm_108351659__c_opt_9aa02bd4', 'file_name': 'init-tablet-split', 'pkg': 'knowledge/graph/livegraph/tools/release-tools'}, 'run': False}, 'livegraph_log_info': {'sorted': True, 'key_values': {'use_large_experiments_topic': False, 'run_loader': False, 'batch_input_goops_topic': '/pubsub2/test/livegraph-batch-input:solma-nov21-d-side_a', 'allow_experiments': False, 'topic_server_epoch_completion_topic': '/pubsub2/test/ephemeral:topicserver-epoch-complete-solma-nov21-d-side_a', 'disable_client_subscriber_topics': False, 'run_gatekeeper': False, 'deadline_days': 1, 'unified_exp_loader_topic': '/pubsub2/test/ephemeral:livegraph-input-mini-expt-solma-nov21-d-side_a', 'pinax_cluster_full': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'source_data_base_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source', 'run_load_rm_signals': False, 'canary_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary-canary', 'geo_loader_livegraph_publisher_topic': '', 'livegraph_output_topic_suffix': 'solma-nov21-d-side_a', 'run_exp_validators': False, 'livegraph_output_topic_prefix': '', 'epoch_notification_topic': '/pubsub2/test/ephemeral:livegraph-epoch-complete-solma-nov21-d-side_a', 'geo_loader_livegraph_publisher_realtime_topic': '', 'input_environment': 'solma-nov21-d', 'run_as_datacanary': False, 'run_geo_loader': False, 'run_election': False, 'loading_tags': 'mini', 'update_exp_borg_job_topic': '/pubsub2/test/ephemeral:livegraph-update-exp-borg-job-solma-nov21-d-side_a', 'input_goops_topic': '/pubsub2/test/livegraph-input:solma-nov21-d', 'run_exp_data_tracking': False, 'run_promote_mid': False, 'include_batch_monitor': False, 'run_table_stats': False, 'run_geo_loader_validator': False, 'run_borgmon': False, 'instance_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a', 'prod_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary', 'run_pinax_repair': False, 'kg_schema_root_dir': '/namespace/livegraph/global/schema/ttl=30d'}}, 'input_environment_var': 'input_environment', 'environment_var': 'instance', 'mpm_version': 'test_mpm_108351659__c_opt_9aa02bd4', 'is_prod': False, 'livegraph_required_pinax_cluster': {'die_after_days': 1, 'setschema_show_diff': False, 'schema_mpm': {'version': 'test_mpm_108351659__c_opt_9aa02bd4', 'filegroups': 'data', 'pkg_name': 'knowledge/graph/livegraph'}, 'clear_production_fields': True, 'schema': 'knowledge/graph/livegraph/storage/livegraph.schema.template', 'bt_prefix': 'livegraph-dev.solma-nov21-d-side_a.pinax', 'partition': 'default', 'metadata_dir': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'administrators': 'chubby!mdb/livegraph-dev', 'default_owner_as_user': False, 'bt_cell': 'qf-i-shared', 'writers': ['chubby!mdb/livegraph-dev'], 'schema_template_substitution_map': {'partition': 'default', 'table_writers': ['chubby!mdb/livegraph-dev'], 'table_administrator': 'chubby!mdb/livegraph-dev', 'table_owner': 'chubby!mdb/livegraph-dev', 'write_only_fs_root_id': 0, 'bt_cell': None, 'data_fs_root_id': 0}, 'user': 'livegraph-dev'}, 'user': 'livegraph-dev'}")
  #
  # # self.Environment()._GetHandlerFactoryByRef('mini.handler.Livegraph')(self.BorgCfg().BorgFile(), self.Environment(), borgcfg_vars=self.BorgCfg()._borgcfg_vars, two_pass_borgcfg_parsing=False).GetMini()
  # # self.Environment()._GetHandlerFactoryByRef('mini.handler.Livegraph')(self.BorgCfg().BorgFile(), self.Environment(), borgcfg_vars=self.BorgCfg()._borgcfg_vars, two_pass_borgcfg_parsing=False).GetMini()
  # diff("{'build_targets': {'livegraph_package': {'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'target': 'knowledge/graph/livegraph:livegraph_mpm', 'mpm_label_prefix': 'test_', 'mpm_label_var': 'mpm_version'}, 'livegraph_monitoring_package': {'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'target': 'knowledge/graph/livegraph:livegraph_monitoring_mpm', 'mpm_label_prefix': 'test_', 'mpm_label_var': 'mpm_version'}, 'gatekeeper_package': None, 'livegraph_config_package': {'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'target': 'knowledge/graph/livegraph:livegraph_config_mpm', 'mpm_label_prefix': 'test_', 'mpm_label_var': 'config_mpm_version'}, 'pinax_package': {'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'target': 'knowledge/graph/livegraph:pinax_mpm', 'mpm_label_prefix': 'test_', 'mpm_label_var': 'mpm_version'}, 'livegraph_release_tools_package': None}, 'pubsub_subscribers': {'client_input': {'id': 'livegraph_dev_sub:solma-nov21-d-side_a', 'topics': '/pubsub2/test/livegraph-input:solma-nov21-d-side_a'}}, 'required_files': {'global_pinax_cluster': None, 'exp_source_data_checkpoint_file': None, 'source_data_checkpoint_file': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source_data_checkpoint', 'user': 'livegraph-dev'}}, 'handler': 'mini.handler.Livegraph', 'worker_job_name': 'livegraph-solma-nov21-d-side_a.workers', 'mpm_extra_label': None, 'default_binary_ref': '@none', 'user_var': 'user', 'cell': 'qf', 'required_directories': {'event_log_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/event-logs/ttl=7d', 'user': 'livegraph-dev'}, 'prewrite_cleaner_flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/prewrite_cleaner', 'user': 'livegraph-dev'}, 'exp_source_data_basedir': None, 'source_data_basedir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source', 'delete_on_purge': True, 'user': 'livegraph-dev'}, 'instance_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a', 'user': 'livegraph-dev'}, 'flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/flagfiles', 'user': 'livegraph-dev'}, 'gatekeeper_base_dir': None, 'validators_base_dir': None, 'mr_table_stats_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/mr-table-stats-logs/ttl=7d', 'user': 'livegraph-dev'}, 'gc_record_working_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/gc/ttl=7d', 'user': 'livegraph-dev'}, 'kg_schema_root_dir': {'name': '/namespace/livegraph/global/schema/ttl=30d', 'delete_on_purge': False, 'user': 'livegraph-dev'}}, 'deadline_days': 1, 'init_tablet_split': {'mpm': {'version': 'test_mpm_108351659__c_opt_9aa02bd4', 'file_name': 'init-tablet-split', 'pkg': 'knowledge/graph/livegraph/tools/release-tools'}, 'run': False}, 'livegraph_log_info': {'sorted': True, 'key_values': {'use_large_experiments_topic': False, 'run_loader': False, 'batch_input_goops_topic': '/pubsub2/test/livegraph-batch-input:solma-nov21-d-side_a', 'allow_experiments': False, 'topic_server_epoch_completion_topic': '/pubsub2/test/ephemeral:topicserver-epoch-complete-solma-nov21-d-side_a', 'disable_client_subscriber_topics': False, 'run_gatekeeper': False, 'deadline_days': 1, 'unified_exp_loader_topic': '/pubsub2/test/ephemeral:livegraph-input-mini-expt-solma-nov21-d-side_a', 'pinax_cluster_full': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'source_data_base_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source', 'run_load_rm_signals': False, 'canary_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary-canary', 'geo_loader_livegraph_publisher_topic': '', 'livegraph_output_topic_suffix': 'solma-nov21-d-side_a', 'run_exp_validators': False, 'livegraph_output_topic_prefix': '', 'epoch_notification_topic': '/pubsub2/test/ephemeral:livegraph-epoch-complete-solma-nov21-d-side_a', 'geo_loader_livegraph_publisher_realtime_topic': '', 'input_environment': 'solma-nov21-d', 'run_as_datacanary': False, 'run_geo_loader': False, 'run_election': False, 'loading_tags': 'mini', 'update_exp_borg_job_topic': '/pubsub2/test/ephemeral:livegraph-update-exp-borg-job-solma-nov21-d-side_a', 'input_goops_topic': '/pubsub2/test/livegraph-input:solma-nov21-d', 'run_exp_data_tracking': False, 'run_promote_mid': False, 'include_batch_monitor': False, 'run_table_stats': False, 'run_geo_loader_validator': False, 'run_borgmon': False, 'instance_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a', 'prod_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary', 'run_pinax_repair': False, 'kg_schema_root_dir': '/namespace/livegraph/global/schema/ttl=30d'}}, 'input_environment_var': 'input_environment', 'environment_var': 'instance', 'mpm_version': 'test_mpm_108351659__c_opt_9aa02bd4', 'is_prod': False, 'livegraph_required_pinax_cluster': {'die_after_days': 1, 'setschema_show_diff': False, 'schema_mpm': {'version': 'test_mpm_108351659__c_opt_9aa02bd4', 'filegroups': 'data', 'pkg_name': 'knowledge/graph/livegraph'}, 'clear_production_fields': True, 'schema': 'knowledge/graph/livegraph/storage/livegraph.schema.template', 'bt_prefix': 'livegraph-dev.solma-nov21-d-side_a.pinax', 'partition': 'default', 'metadata_dir': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'administrators': 'chubby!mdb/livegraph-dev', 'default_owner_as_user': False, 'bt_cell': 'qf-i-shared', 'writers': ['chubby!mdb/livegraph-dev'], 'schema_template_substitution_map': {'partition': 'default', 'table_writers': ['chubby!mdb/livegraph-dev'], 'table_administrator': 'chubby!mdb/livegraph-dev', 'table_owner': 'chubby!mdb/livegraph-dev', 'write_only_fs_root_id': 0, 'bt_cell': None, 'data_fs_root_id': 0}, 'user': 'livegraph-dev'}, 'user': 'livegraph-dev'}",
  #      "{'build_targets': {'livegraph_package': {'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'target': 'knowledge/graph/livegraph:livegraph_mpm', 'mpm_label_prefix': 'test_', 'mpm_label_var': 'mpm_version'}, 'livegraph_monitoring_package': {'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'target': 'knowledge/graph/livegraph:livegraph_monitoring_mpm', 'mpm_label_prefix': 'test_', 'mpm_label_var': 'mpm_version'}, 'gatekeeper_package': None, 'livegraph_config_package': {'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'target': 'knowledge/graph/livegraph:livegraph_config_mpm', 'mpm_label_prefix': 'test_', 'mpm_label_var': 'config_mpm_version'}, 'pinax_package': {'build_options': {'extra_label': None, 'durability': '--mpm_build_arg=--durability=TEST'}, 'target': 'knowledge/graph/livegraph:pinax_mpm', 'mpm_label_prefix': 'test_', 'mpm_label_var': 'mpm_version'}, 'livegraph_release_tools_package': None}, 'pubsub_subscribers': {'client_input': {'id': 'livegraph_dev_sub:solma-nov21-d-side_a', 'topics': '/pubsub2/test/livegraph-input:solma-nov21-d-side_a'}}, 'required_files': {'global_pinax_cluster': None, 'exp_source_data_checkpoint_file': None, 'source_data_checkpoint_file': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source_data_checkpoint', 'user': 'livegraph-dev'}}, 'required_pinax_cluster': {'die_after_days': 1, 'setschema_show_diff': False, 'schema_mpm': {'version': 'test_mpm_108351659__c_opt_9aa02bd4', 'filegroups': 'data', 'pkg_name': 'knowledge/graph/livegraph'}, 'clear_production_fields': True, 'schema': '/tmp/mini-repo-3c5b546b8bf1695b5a7c8090700972c886f369d2/google3/livegraph_concrete.schema', 'bt_prefix': 'livegraph-dev.solma-nov21-d-side_a.pinax', 'partition': 'default', 'metadata_dir': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'administrators': 'chubby!mdb/livegraph-dev', 'default_owner_as_user': False, 'bt_cell': 'qf-i-shared', 'writers': ['chubby!mdb/livegraph-dev'], 'schema_template_substitution_map': {'partition': 'default', 'table_writers': ['chubby!mdb/livegraph-dev'], 'table_administrator': 'chubby!mdb/livegraph-dev', 'table_owner': 'chubby!mdb/livegraph-dev', 'write_only_fs_root_id': 0, 'bt_cell': None, 'data_fs_root_id': 0}, 'user': 'livegraph-dev'}, 'handler': 'mini.handler.Livegraph', 'worker_job_name': 'livegraph-solma-nov21-d-side_a.workers', 'mpm_extra_label': None, 'default_binary_ref': '@none', 'user_var': 'user', 'cell': 'qf', 'required_directories': {'event_log_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/event-logs/ttl=7d', 'user': 'livegraph-dev'}, 'prewrite_cleaner_flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/prewrite_cleaner', 'user': 'livegraph-dev'}, 'exp_source_data_basedir': None, 'source_data_basedir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source', 'delete_on_purge': True, 'user': 'livegraph-dev'}, 'instance_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a', 'user': 'livegraph-dev'}, 'flagfiles': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/flagfiles', 'user': 'livegraph-dev'}, 'gatekeeper_base_dir': None, 'validators_base_dir': None, 'mr_table_stats_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/mr-table-stats-logs/ttl=7d', 'user': 'livegraph-dev'}, 'gc_record_working_dir': {'name': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/gc/ttl=7d', 'user': 'livegraph-dev'}, 'kg_schema_root_dir': {'name': '/namespace/livegraph/global/schema/ttl=30d', 'delete_on_purge': False, 'user': 'livegraph-dev'}}, 'deadline_days': 1, 'init_tablet_split': {'mpm': {'version': 'test_mpm_108351659__c_opt_9aa02bd4', 'file_name': 'init-tablet-split', 'pkg': 'knowledge/graph/livegraph/tools/release-tools'}, 'run': False}, 'livegraph_log_info': {'sorted': True, 'key_values': {'use_large_experiments_topic': False, 'run_loader': False, 'batch_input_goops_topic': '/pubsub2/test/livegraph-batch-input:solma-nov21-d-side_a', 'allow_experiments': False, 'topic_server_epoch_completion_topic': '/pubsub2/test/ephemeral:topicserver-epoch-complete-solma-nov21-d-side_a', 'disable_client_subscriber_topics': False, 'run_gatekeeper': False, 'deadline_days': 1, 'unified_exp_loader_topic': '/pubsub2/test/ephemeral:livegraph-input-mini-expt-solma-nov21-d-side_a', 'pinax_cluster_full': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'source_data_base_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a/source', 'run_load_rm_signals': False, 'canary_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary-canary', 'geo_loader_livegraph_publisher_topic': '', 'livegraph_output_topic_suffix': 'solma-nov21-d-side_a', 'run_exp_validators': False, 'livegraph_output_topic_prefix': '', 'epoch_notification_topic': '/pubsub2/test/ephemeral:livegraph-epoch-complete-solma-nov21-d-side_a', 'geo_loader_livegraph_publisher_realtime_topic': '', 'input_environment': 'solma-nov21-d', 'run_as_datacanary': False, 'run_geo_loader': False, 'run_election': False, 'loading_tags': 'mini', 'update_exp_borg_job_topic': '/pubsub2/test/ephemeral:livegraph-update-exp-borg-job-solma-nov21-d-side_a', 'input_goops_topic': '/pubsub2/test/livegraph-input:solma-nov21-d', 'run_exp_data_tracking': False, 'run_promote_mid': False, 'include_batch_monitor': False, 'run_table_stats': False, 'run_geo_loader_validator': False, 'run_borgmon': False, 'instance_dir': '/cns/qf-d/home/livegraph-dev/instances/ttl=1d/solma-nov21-d-side_a', 'prod_epoch_gating_topic': '/pubsub2/service/livegraph-epoch-flow-control:data-canary', 'run_pinax_repair': False, 'kg_schema_root_dir': '/namespace/livegraph/global/schema/ttl=30d'}}, 'input_environment_var': 'input_environment', 'environment_var': 'instance', 'mpm_version': 'test_mpm_108351659__c_opt_9aa02bd4', 'is_prod': False, 'livegraph_required_pinax_cluster': {'die_after_days': 1, 'setschema_show_diff': False, 'schema_mpm': {'version': 'test_mpm_108351659__c_opt_9aa02bd4', 'filegroups': 'data', 'pkg_name': 'knowledge/graph/livegraph'}, 'clear_production_fields': True, 'schema': '/tmp/mini-repo-3c5b546b8bf1695b5a7c8090700972c886f369d2/google3/livegraph_concrete.schema', 'bt_prefix': 'livegraph-dev.solma-nov21-d-side_a.pinax', 'partition': 'default', 'metadata_dir': '/ls/qf/storage/pinax/production/testing/ttl=1d/livegraph-solma-nov21-d-side_a', 'administrators': 'chubby!mdb/livegraph-dev', 'default_owner_as_user': False, 'bt_cell': 'qf-i-shared', 'writers': ['chubby!mdb/livegraph-dev'], 'schema_template_substitution_map': {'partition': 'default', 'table_writers': ['chubby!mdb/livegraph-dev'], 'table_administrator': 'chubby!mdb/livegraph-dev', 'table_owner': 'chubby!mdb/livegraph-dev', 'write_only_fs_root_id': 0, 'bt_cell': None, 'data_fs_root_id': 0}, 'user': 'livegraph-dev'}, 'user': 'livegraph-dev'}")
